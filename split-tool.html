<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Split Photo Tool</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #1a1a1a; color: #e5e5e5; min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 40px 20px; }
  h1 { font-size: 1.5rem; font-weight: 600; margin-bottom: 8px; }
  .subtitle { color: #888; font-size: 0.9rem; margin-bottom: 32px; }

  .controls { display: flex; gap: 24px; margin-bottom: 32px; flex-wrap: wrap; justify-content: center; }
  .upload-box { display: flex; flex-direction: column; align-items: center; gap: 8px; }
  .upload-box label { font-size: 0.8rem; color: #aaa; text-transform: uppercase; letter-spacing: 0.08em; }
  .upload-btn { padding: 10px 20px; background: #333; border: 1px solid #555; border-radius: 8px; color: #e5e5e5; font-size: 0.85rem; cursor: pointer; transition: background 0.2s; }
  .upload-btn:hover { background: #444; }
  .upload-btn.loaded { border-color: #f97316; color: #f97316; }
  input[type="file"] { display: none; }

  .settings { display: flex; gap: 20px; margin-bottom: 32px; align-items: center; flex-wrap: wrap; justify-content: center; }
  .setting { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: #aaa; }
  .setting select, .setting input[type="range"] { background: #333; border: 1px solid #555; border-radius: 6px; color: #e5e5e5; padding: 4px 8px; font-size: 0.85rem; }
  .setting input[type="range"] { width: 120px; accent-color: #f97316; }

  #canvas-wrap { position: relative; border: 1px solid #333; border-radius: 12px; overflow: hidden; background: #111; }
  canvas { display: block; }

  .actions { margin-top: 24px; display: flex; gap: 12px; }
  .actions button { padding: 10px 24px; border-radius: 8px; font-size: 0.9rem; font-weight: 500; cursor: pointer; transition: all 0.2s; }
  .btn-primary { background: #f97316; color: #fff; border: none; }
  .btn-primary:hover { background: #ea580c; }
  .btn-secondary { background: transparent; color: #aaa; border: 1px solid #555; }
  .btn-secondary:hover { color: #fff; border-color: #888; }
</style>
</head>
<body>

<h1>Split Photo Tool</h1>
<p class="subtitle">Upload light &amp; dark screenshots, get a diagonal split image</p>

<div class="controls">
  <div class="upload-box">
    <label>Left (Light)</label>
    <button class="upload-btn" id="btn-left" onclick="document.getElementById('file-left').click()">Choose image...</button>
    <input type="file" id="file-left" accept="image/*">
  </div>
  <div class="upload-box">
    <label>Right (Dark)</label>
    <button class="upload-btn" id="btn-right" onclick="document.getElementById('file-right').click()">Choose image...</button>
    <input type="file" id="file-right" accept="image/*">
  </div>
</div>

<div class="settings">
  <div class="setting">
    <label>Direction:</label>
    <select id="direction">
      <option value="top-right-to-bottom-left">↘ Top-right → Bottom-left</option>
      <option value="top-left-to-bottom-right">↙ Top-left → Bottom-right</option>
    </select>
  </div>
  <div class="setting">
    <label>Split position:</label>
    <input type="range" id="split-pos" min="20" max="80" value="50">
    <span id="split-label">50%</span>
  </div>
  <div class="setting">
    <label>Edge:</label>
    <select id="edge-style">
      <option value="sharp">Sharp</option>
      <option value="shadow">Shadow line</option>
    </select>
  </div>
</div>

<div id="canvas-wrap">
  <canvas id="canvas" width="960" height="600"></canvas>
</div>

<div class="actions">
  <button class="btn-primary" onclick="download()">Download PNG</button>
  <button class="btn-secondary" onclick="download2x()">Download 2x</button>
</div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let imgLeft = null, imgRight = null;

document.getElementById('file-left').addEventListener('change', e => {
  loadImage(e.target.files[0], img => { imgLeft = img; document.getElementById('btn-left').classList.add('loaded'); document.getElementById('btn-left').textContent = 'Loaded ✓'; render(); });
});
document.getElementById('file-right').addEventListener('change', e => {
  loadImage(e.target.files[0], img => { imgRight = img; document.getElementById('btn-right').classList.add('loaded'); document.getElementById('btn-right').textContent = 'Loaded ✓'; render(); });
});
document.getElementById('direction').addEventListener('change', render);
document.getElementById('split-pos').addEventListener('input', e => { document.getElementById('split-label').textContent = e.target.value + '%'; render(); });
document.getElementById('edge-style').addEventListener('change', render);

function loadImage(file, cb) {
  if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    const img = new Image();
    img.onload = () => cb(img);
    img.src = e.target.result;
  };
  reader.readAsDataURL(file);
}

function render(scale) {
  scale = scale || 1;
  if (!imgLeft && !imgRight) { drawPlaceholder(); return; }
  const ref = imgLeft || imgRight;
  const w = ref.naturalWidth;
  const h = ref.naturalHeight;
  canvas.width = w * scale;
  canvas.height = h * scale;
  canvas.style.maxWidth = Math.min(w, 960) + 'px';
  ctx.save();
  ctx.scale(scale, scale);

  const dir = document.getElementById('direction').value;
  const splitPct = parseInt(document.getElementById('split-pos').value) / 100;
  const edgeStyle = document.getElementById('edge-style').value;

  // Draw right (dark) side full
  if (imgRight) ctx.drawImage(imgRight, 0, 0, w, h);
  else ctx.clearRect(0, 0, w, h);

  // Clip left (light) side
  ctx.save();
  ctx.beginPath();
  if (dir === 'top-right-to-bottom-left') {
    const topX = w * splitPct + w * 0.08;
    const botX = w * splitPct - w * 0.08;
    ctx.moveTo(0, 0);
    ctx.lineTo(topX, 0);
    ctx.lineTo(botX, h);
    ctx.lineTo(0, h);
  } else {
    const topX = w * splitPct - w * 0.08;
    const botX = w * splitPct + w * 0.08;
    ctx.moveTo(0, 0);
    ctx.lineTo(topX, 0);
    ctx.lineTo(botX, h);
    ctx.lineTo(0, h);
  }
  ctx.closePath();
  ctx.clip();
  if (imgLeft) ctx.drawImage(imgLeft, 0, 0, w, h);
  ctx.restore();

  // Edge line
  if (edgeStyle === 'shadow') {
    ctx.save();
    const topX = dir === 'top-right-to-bottom-left' ? w * splitPct + w * 0.08 : w * splitPct - w * 0.08;
    const botX = dir === 'top-right-to-bottom-left' ? w * splitPct - w * 0.08 : w * splitPct + w * 0.08;
    ctx.beginPath();
    ctx.moveTo(topX, 0);
    ctx.lineTo(botX, h);
    ctx.strokeStyle = 'rgba(0,0,0,0.3)';
    ctx.lineWidth = 2 * scale;
    ctx.shadowColor = 'rgba(0,0,0,0.5)';
    ctx.shadowBlur = 8 * scale;
    ctx.stroke();
    ctx.restore();
  }

  ctx.restore();
}

function drawPlaceholder() {
  canvas.width = 960; canvas.height = 600;
  ctx.fillStyle = '#222';
  ctx.fillRect(0, 0, 960, 600);
  ctx.fillStyle = '#555';
  ctx.font = '16px -apple-system, sans-serif';
  ctx.textAlign = 'center';
  ctx.fillText('Upload two screenshots to preview the split', 480, 300);
}

function download() {
  render(1);
  const a = document.createElement('a');
  a.download = 'split-screenshot.png';
  a.href = canvas.toDataURL('image/png');
  a.click();
}

function download2x() {
  render(2);
  const a = document.createElement('a');
  a.download = 'split-screenshot@2x.png';
  a.href = canvas.toDataURL('image/png');
  a.click();
  render(1);
}

drawPlaceholder();
</script>
</body>
</html>
